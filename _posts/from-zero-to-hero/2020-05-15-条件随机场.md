---
title: "条件随机场"
subtitle: "Conditionnal Random Field"
layout: post
author: "echisenyang"
header-style: text
hidden: true
catalog: true
tags:
  - 输出计划
  - 李航统计学习第二版
  - PRML
---



![2mF1kT](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/2mF1kT.jpg)

![11.条件随机场-2](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/11.条件随机场-2.jpg)

![11.条件随机场-3](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/11.条件随机场-3.jpg)




### 条件随机场

#### 马尔可夫性

- 马尔科夫性是是保证或者判断概率图是否为概率无向图的条件。

---

#### 生成模型 vs 判别模型

<img src="https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/q5AQde.jpg" alt="q5AQde" style="zoom: 33%;" />

- 判别模型

**直接学习 $p(y \mid x)$，判别式模型根据所提供的feature直接学习一个分类边界**

- 生成模型

**生成模型学习的是联合概率 $p(x,y)=p(x \mid y)p(y)$，然后利用贝叶斯定理来求解后验概率 $p(y \mid x)$** 
$$
p(y \mid x) = \frac{p(x \mid y)p(y)}{\sum_{y{}' \epsilon \gamma} p(x \mid y{}')p(y{}')}
$$

---

#### 「熵」

「熵（shāng）」是一个抽象的通过运算推导出来的量。其物理意义代表**系统的无序程度**。

- 比如：蜡烛燃烧、冰块融化、酒精挥发、食物腐烂等都是熵增加的过程。而与之相反的过程是熵减。

**「热力学第一定律」**即**「能量守恒定律(energy conservation law)」指在一个封闭(孤立)系统的总能量保持不变。**

- 能量既不会凭空产生，也不会凭空消失，它只会从一种形式转化为另一种形式，或者从一个物体转移到其它物体，而能量的总量保持不变。能量守恒定律是自然界普遍的基本定律之一，但是科学家们发现，**能量总是做不到100%的转换**，什么意思？科学家们发现，**有相当一部分的能量在转换的过程中被耗散掉了（变成了震动、噪音、热辐射等等），这部分在转换过程中耗散的、无法再利用的能量就是「熵」。**

**「热力学第二定律」**

- 「热力学第二定律」的内涵非常丰富，每种表述都反映了它的一个侧面，包括：**克劳修斯表述**、开尔文表述、普朗克表述、黑首保劳-肯南表述、卡拉西奥多里原理。在这些表述之中，比较经典就是克劳修斯表述——**「熵增加原理」**：**孤立系统的熵值永远是增加的(更精确的说，是永不减少)。**

1、孤立系统

在热力学之中，**与外界没有物质交换，但有能量交换的系统称为「封闭系统」**，比如：密封的不保温的不锈钢水杯。在热力学之中，**与外界既没有物质交换也没有能量交换的系统称为「孤立系统」**，比如：密封的绝对保温的不锈钢水杯（理论上存在）

2、「熵值」永远是增加的，永不减少

我们之前说过，在转换过程中耗散的、无法再利用的能量就是「熵」，又根据「能量守恒定律」这些能量并没有消失，只是由**“可以利用的能量”**变成了**“无法利用能量”**。从“可以利用的能量”到“无法利用的能量”，其实就是能量的分布由**“聚在一起”**变成了**“平均分布”**。**只有“聚在一起”的能量才是能够被利用的，而“平均分布”的能量则不能被利用**

![4teAEZ](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/4teAEZ.jpg)

我们把水坝暂时看作一个「孤立系统」（外界的物质与能量无法影响到它）。这时水坝一侧的水位比另一侧要高，**水的重力势能“聚在一起”**，当我们打开水坝，水就会倾泻而出，倾泻而出的水可以带动发电机发电。这时的能量转换就是：**（水）重力势能→ 机械能→ 电能。**那么如果说**水坝两侧的水位是相等的话，水就“平均分布”了**，不会流动，我们也就**无法利用**水来发电。例子中的**“聚在一起”的能量，是一种「有序的能量」（熵值小）**，它会朝一个方向运动，是可以被利用的。而**“平均分布”的能量，是一种「无序的能量」（熵值大）**，它不会自发的运动，不可以被利用。

<img src="https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/6lEdgq.jpg" alt="6lEdgq" style="zoom:50%;" />

我们回到「熵增加原理」，**「熵值」增加的意思就是——无法利用的能量会越来越多。**综上所述，「熵增加原理」的意思是：**在没有外界影响的情况下（孤立系统）无法利用的能量会越来越多，而且这个过程无法自发逆转。**霍金的解释是**「熵减」（逆转）**来自于系统外部，不可能来自内部。所以整个孤立系统的能量会慢慢变成“你有我有全都有”的**平衡状态。**

![Yg9kDt](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/Yg9kDt.jpg)

---

#### 最大熵模型

<img src="https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/XFwHN2.png" alt="XFwHN2" style="zoom:50%;" />

![KGfvC6](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/KGfvC6.png)

#### MEMM

Max Entropy Markov Model最大熵马尔可夫模型，**在最大熵的基础上引入了一阶马尔科夫假设**。

![vHe5he](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/vHe5he.jpg)

MEMM takes into account **the dependencies between neighboring states** and the entire observed sequence, hence a better expression ability. **MEMM does not consider P(X), which reduces the modeling workload** and learns the consistency between the target function and the estimated function.

- **MEMM Labeling Bias**

![oC8uRN](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/oC8uRN.jpg)

**State 1 tends to convert to State 2, and State 2 tends to stay at State 2 at the same time.**
$$
P(1-> 1-> 1-> 1)= 0.4 * 0.45 * 0.5 = 0.09 \\
P(2->2->2->2)= 0.2 * 0.3 * 0.3 = 0.018 \\
P(1->2->1->2)= 0.6 * 0.2 * 0.5 = 0.06 \\
P(1->1->2->2)= 0.4 * 0.55 * 0.3 = 0.066
$$
**However, the optimal state conversion path is 1 > 1 > 1 >1. Why?**

- It is because State 2 has more convertible states than State 1 does, hence reducing the conversion probability — **MEMM tends to select the state with fewer convertible states. Such selection is termed the labeling bias issue**. CRF well addresses the labeling bias issue. 因为 state2 有更多的转移状态（5个），而 state1 只有2个转移状态。**MEMM的标注偏差问题正是由于其偏向于选择转移状态少的state而引起的**。

#### CRF model

![D0jGSZ](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/D0jGSZ.jpg)

![ipDCP3](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/ipDCP3.png)

<img src="https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/adlIVF.png" alt="adlIVF" style="zoom:50%;" />

![g5iVa4](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/g5iVa4.png)

<img src="https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/yOkr6A.png" alt="yOkr6A" style="zoom:50%;" />

