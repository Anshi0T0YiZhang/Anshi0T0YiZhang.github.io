---
title: "推荐系统概述"
subtitle: "RecommendationSystemFundamentals"
layout: post
author: "echisenyang"
header-style: text
hidden: false
catalog: true
tags:
  - 推荐系统

---





## 传统推荐系统及深度学习推荐系统的演化关系图

- ref：项亮老师《推荐系统实践》；王喆老师《深度学习推荐系统》

![wb0sGg](https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/wb0sGg.png)

## **核心内容：**

1. **协同过滤算法**: 

   包括**基于用户的协同过滤(UserCF)**和**基于商品的协同过滤(ItemCF)**，这是入门推荐系统的人必看的内容，因为这些算法可以让初学者更加容易的理解推荐算法的思想。

2. **矩阵分解算法:** 

   矩阵分解算法通过**引入了隐向量的概念，加强了模型处理稀疏矩阵的能力**，也为后续深度学习推荐系统算法中Embedding的使用打下了基础。

3. **FM(Factorization Machines):** 

   该算法属于对**逻辑回归(LR)算法应用在推荐系统上的一个改进**，在LR模型的基础上加上了特征交叉项，该思想不仅在传统的推荐算法中继续使用过，在深度学习推荐算法中也对其进行了改进与应用。

4. **GBDT+LR:** 

   该模型仍然是**对LR模型的改进**，使用树模型做特征交叉，相比于FM的二阶特征交叉，树模型可以对特征进行深度的特征交叉，充分利用了特征之间的相关性。

5. **Wide&Deep:** 

   从**深度学习推荐系统**的演化图中可以看出Wide&Deep模型处在最中间的位置，可以看出该模型在推荐系统发展中的重要地位，此外该算法模型的思想与实现都比较的简单，非常适合初学深度学习推荐系统的学习者们去学习。





## 推荐系统简介

#### **What**

- 用户：推荐系统是一种帮助用户快速发现有用信息的工具
- 公司：推荐系统是一种增加公司产品与用户接触,购买等行为概率的工具

#### **Why**

- 用户：在用户需求并不十分明确的情况下进行信息的过滤,与搜索系统相比,推荐系统更多的利用用户的各类历史信息猜测其可能喜欢的内容
- 公司：解决产品能够最大限度地吸引用户,留存用户,增长用户黏性,提高用户转化率,从而达到公司商目标连续增长的目的.

> **本质上是一种实现将用户-商品-公司之间利益最大化的手段.**

#### **Who**

从上面的1和2可以看出用户与公司是需要推荐系统的主要对象，那么可以在1和2的基础上展开想想什么样子的人需要推荐系统，以及什么样的公司需要推荐系统。





## 常用评测指标

- **用户满意度**
- **预测准确度**
  - **评分预测** ($RMSE$、$MAE$)
  - **TopN推荐** (precision、recall)
- **覆盖率**
  - 信息熵定义覆盖率：$H=-\sum_{i=1}^{n} p(i) \log p(i)$
  - 基尼系数定义覆盖率：$G=\frac{1}{n-1} \sum_{j=1}^{n}(2 j-n-1) p\left(i_{j}\right)$
- **多样性**
  - 推荐系统多样性：Diversity $=\frac{1}{U} \sum_{u \in U}$ Diversity $(R(u))$，$\operatorname{Diversity}(R(u))=1-\frac{\sum_{i, j \in R(u)} s(i, j)}{\frac{1}{2} \mid R(u) \mid (\mid R(u)\mid -1)}$
- **新颖性**
  - 满足推荐的新颖性最简单的方法就是给用户推荐他们之前没有看过的物品,但是每个用户没见过的物品数量是非常庞大的,所以一般会计算推荐物品的平均流行度,流行度越低的物品越有可能让用户觉得新颖,因此,如果推荐结果中的物品平均热门程度比较低说明推荐的结果就可能比较新颖.
- **AUC曲线**





## 召回

- **召回层在推荐系统架构中的位置及作用**
  - 在推荐系统架构中召回层与排序层是推荐系统的核心算法层，而将推荐过程分成召回层与排序层主要是基于工程上的考虑，其中**召回阶段负责将海量的候选集快速缩小为几万到几千的规模；而排序层则负责对缩小后的候选集进行精准排序**。所以在召回阶段往往会利用少量的特征和简单的模型对大规模的数据集进行快速的筛选，而在排序层一般会使用更多的特征和更加复杂的模型进行精准的排序。
- **召回层与排序层的特点**
  - **召回层：** 待计算的候选集合大、计算速度快、模型简单、特征较少，尽量让用户感兴趣的物品在这个阶段能够被快速召回，即保证相关物品的召回率
  - **排序层：** 首要目标是得到精准的排序结果。需要处理的物品数量少，可以利用较多的特征，使用比较复杂的模型。

> 在设计召回层时，“计算速度”和“召回率”其实是矛盾的两个指标，为提高“计算速度”，需要使召回策略尽量简单一些；而为了提高“召回率”，要求召回策略尽量选出排序模型所需要的候选集，这也就要求召回策略不能过于简单。在权衡计算速度和召回率后，目前工业界主流的召回方法是采用多个简单策略叠加的“多路召回策略”

- **多路召回策略**
  - 所谓的“多路召回”策略，就是指采用不同的策略、特征或简单模型，分别召回一部分候选集，然后把候选集混合在一起供后续排序模型使用，可以明显的看出，“多路召回策略”是在“计算速度”和“召回率”之间进行权衡的结果。其中，各种简单策略保证候选集的快速召回，从不同角度设计的策略保证召回率接近理想的状态，不至于损伤排序效果。

<img src="https://gitee.com/echisenyang/GiteeForUpicUse/raw/master/uPic/spITqn.png" alt="spITqn" style="zoom:50%;" />

> 上图只是一个多路召回的例子，也就是说可以使用多种不同的策略来获取用户排序的候选商品集合，**而具体使用哪些召回策略其实是与业务强相关的**，针对不同的任务就会有对于该业务真实场景下需要考虑的召回规则。例如视频推荐，召回规则可以是“热门视频”、“导演召回”、“演员召回”、“最近上映“、”流行趋势“、”类型召回“等等。



- **多路召回存在的问题**

  - 虽然多路召回权衡了计算速度和召回率的问题，可以使得用于排序的候选商品更加的丰富，但是实际的多路召回仍然存在一些问题。如上图所示，对于每一路召回都会从商品集合中拉回K个商品，这里的K是一个超参数，对于K的选择一般需要通过离线评估加线上的A/B测试来确定合理的K值。除此之外，对于不同的任务具体策略的选择也是人工基于经验的选择，选择的策略之间的信息是割裂的，无法综合考虑不同策略对一个物品的影响。

- **Embedding召回**

  - 在当前的主流推荐系统中，Embedding的身影已经无处不在，从一定意义上可以说，把Embedding做好了，整个推荐系统的一个难题就攻克了。

- **常见的Embedding技术有哪些？**

  - text embedding

    - 在推荐系统领域，text embedding技术是目前使用最多的embedding技术，对于文本特征可以直接使用该技术，**对于非文本的id类特征，可以先将其转化成id序列再使用text embedding的技术获取id的embedding再做召回**。

    - 常见的text Embedding的技术有：

      **静态向量**：word2vec, fasttext, glove

      **动态向量**：ELMO, GPT, BERT

  - image embedding

    - 对于image embedding其实主要是对于有图或者视频的特征，目前计算机视觉模型已经发展的比较成熟了，对于图像与视频的识别都有效果比较好的模型，大部分都是卷积模块通过各种连接技巧搭建的高效模型，**可以使用现有的预训练模型提取图像或者视频的向量特征**，然后用于召回。

  - graph embedding

    - **对于社交网络相关的推荐，进行推荐的用户与用于之间或者商品之间天然的存在某种复杂的图结构的关系，如何利用图中节点与节点之间的关系对其进行向量化是非常关键的**，在这种场景下基于序列的text embedding和基于卷积模型的image embedding都显得力不从心，在这样的背景下Graph Embedding逐渐在推荐系统中流行起来。经典的Graph Embedding模型有, Deep Walk, Node2Vec，LINE以及比较新的阿里巴巴2018年公布的EGES graph Embedding模型。



## reference

[腾讯技术工程 $\mid$ 推荐系统embedding技术实践总结](https://zhuanlan.zhihu.com/p/143763320)




